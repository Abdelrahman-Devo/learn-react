// ==============================
// ุฅุนุฏุงุฏ ุงูุฎุทุฉ ุงููุงููุฉ (ุนุฑุจู + ุฅูุฌููุฒู)
// ==============================
const plan = {
    ar: [
      {
        week: "ุงูุฃุณุจูุน ุงูุฃูู: ุฃุณุงุณูุงุช JavaScript",
        days: [
          "ุงูููู 1-2: ููู ุงููุชุบูุฑุงุช ูุฃููุงุน ุงูุจูุงูุงุช",
          "ุงูููู 3-4: ุงูุฏูุงู ู ุงูู Scope",
          "ุงูููู 5: ุงููุงุฆูุงุช ูุงููุตูููุงุช",
          "ุงูููู 6-7: ููุงููู ES6 ุงูุญุฏูุซุฉ"
        ],
        resources: [
          { name: "๐บ ุฏูุฑุฉ ุฌุงูุงุณูุฑุจุช Elzero", url: "https://www.youtube.com/playlist?list=PLDoPjvoNmBAxXTPncg0W4lhVS32LO_xtQ" },
          { name: "๐บ freeCodeCamp", url: "https://www.youtube.com/watch?v=PkZNo7MFNFg" },
          { name: "๐ JavaScript.info", url: "https://javascript.info/" }
        ]
      },
      {
        week: "ุงูุฃุณุจูุน ุงูุซุงูู: ุงูุจูุฆุฉ ุงูุญุฏูุซุฉ + React Basics",
        days: [
          "ุงูููู 1-2: ุชุซุจูุช Node.js ูุชููุฆุฉ ูุดุฑูุน React ุจุงุณุชุฎุฏุงู Vite",
          "ุงูููู 3: JSX ู Virtual DOM",
          "ุงูููู 4-5: ุงูููููุงุช (Function Components)",
          "ุงูููู 6-7: ูุดุฑูุน ุตุบูุฑ (ูุงุฆูุฉ ููุงู)"
        ],
        resources: [
          { name: "๐บ React Crash Course - Traversy", url: "https://www.youtube.com/watch?v=w7ejDZ8SWv8" },
          { name: "๐บ Net Ninja React Tutorial", url: "https://www.youtube.com/playlist?list=PL4cUxeGkcC9i0_Pn1343Oe9-Xd6Kql1wU" },
          { name: "๐ React Docs Quick Start", url: "https://react.dev/learn" }
        ]
      },
      {
        week: "ุงูุฃุณุจูุน ุงูุซุงูุซ: ุงูุญุงูุฉ (State) ูุงูููุงุทุน (Props)",
        days: [
          "ุงูููู 1: ููู ููููู ุงูู State ูู React",
          "ุงูููู 2-3: ุงุณุชุฎุฏุงู useState ูุน ุงูุฃูุซูุฉ",
          "ุงูููู 4: ุชูุฑูุฑ ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู props",
          "ุงูููู 5-6: ุงูุชุนุงูู ูุน ุงูุฃุญุฏุงุซ Events",
          "ุงูููู 7: ูุดุฑูุน ุตุบูุฑ (ุนุฏุงุฏ ุชูุงุนูู ุฃู Toggle)"
        ],
        resources: [
          { name: "๐ React useState Hook", url: "https://react.dev/reference/react/useState" },
          { name: "๐บ React State & Props - Net Ninja", url: "https://www.youtube.com/watch?v=4UZrsTqkcW4" },
          { name: "๐บ Traversy Media: Props & State", url: "https://www.youtube.com/watch?v=w7ejDZ8SWv8&t=2500s" }
        ]
      },
      {
        week: "ุงูุฃุณุจูุน ุงูุฑุงุจุน: ูุดุงุฑูุน + ุฅุฏุงุฑุฉ ุงูุญุงูุฉ + ุงููุดุฑ",
        days: [
          "ุงูููู 1: ูุฑุงุฌุนุฉ useEffect (ุงูุชุฃุซูุฑุงุช ุงูุฌุงูุจูุฉ)",
          "ุงูููู 2-3: ุจูุงุก ูุดุฑูุน ูุงูู (ToDo App ุฃู Weather App)",
          "ุงูููู 4: ุชุญุณูู ุงููุดุฑูุน ูุชูุธูู ุงููููุงุช",
          "ุงูููู 5: ููุฏูุฉ ุนู Context API",
          "ุงูููู 6: ูุดุฑ ุงููุดุฑูุน ุนูู GitHub Pages",
          "ุงูููู 7: ูุฑุงุฌุนุฉ ุนุงูุฉ ูุงุณุชุนุฏุงุฏ ูููุดุงุฑูุน ุงููุงุฏูุฉ"
        ],
        resources: [
          { name: "๐ useEffect Documentation", url: "https://react.dev/reference/react/useEffect" },
          { name: "๐บ Build React App - freeCodeCamp", url: "https://www.youtube.com/watch?v=bMknfKXIFA8" },
          { name: "๐ Deploy React App on GitHub Pages", url: "https://create-react-app.dev/docs/deployment/#github-pages" }
        ]
      }
    ],
    en: [
      {
        week: "Week 1: JavaScript Fundamentals",
        days: [
          "Days 1โ2: Variables and Data Types",
          "Days 3โ4: Functions and Scope",
          "Day 5: Objects and Arrays",
          "Days 6โ7: ES6 Concepts"
        ],
        resources: [
          { name: "๐บ Elzero JS Course", url: "https://www.youtube.com/playlist?list=PLDoPjvoNmBAxXTPncg0W4lhVS32LO_xtQ" },
          { name: "๐บ freeCodeCamp JS Full Course", url: "https://www.youtube.com/watch?v=PkZNo7MFNFg" },
          { name: "๐ JavaScript.info Guide", url: "https://javascript.info/" }
        ]
      },
      {
        week: "Week 2: Modern Setup + React Basics",
        days: [
          "Days 1โ2: Setup Node.js & React project using Vite",
          "Day 3: JSX and Virtual DOM",
          "Days 4โ5: Function Components",
          "Days 6โ7: Mini Project (To-Do List)"
        ],
        resources: [
          { name: "๐บ React Crash Course - Traversy", url: "https://www.youtube.com/watch?v=w7ejDZ8SWv8" },
          { name: "๐บ Net Ninja React Series", url: "https://www.youtube.com/playlist?list=PL4cUxeGkcC9i0_Pn1343Oe9-Xd6Kql1wU" },
          { name: "๐ React Docs Quick Start", url: "https://react.dev/learn" }
        ]
      },
      {
        week: "Week 3: State & Props",
        days: [
          "Day 1: Understanding State in React",
          "Days 2โ3: Working with useState Hook",
          "Day 4: Passing Data with Props",
          "Days 5โ6: Handling Events in React",
          "Day 7: Mini Project (Interactive Counter)"
        ],
        resources: [
          { name: "๐ React useState Hook", url: "https://react.dev/reference/react/useState" },
          { name: "๐บ React State & Props - Net Ninja", url: "https://www.youtube.com/watch?v=4UZrsTqkcW4" },
          { name: "๐บ Traversy Media: Props & State", url: "https://www.youtube.com/watch?v=w7ejDZ8SWv8&t=2500s" }
        ]
      },
      {
        week: "Week 4: Projects + State Management + Deployment",
        days: [
          "Day 1: useEffect Introduction",
          "Days 2โ3: Build a Full React Project (ToDo or Weather App)",
          "Day 4: Organize Components & Folders",
          "Day 5: Introduction to Context API",
          "Day 6: Deploy to GitHub Pages",
          "Day 7: Review & Next Steps"
        ],
        resources: [
          { name: "๐ useEffect Documentation", url: "https://react.dev/reference/react/useEffect" },
          { name: "๐บ Build React App - freeCodeCamp", url: "https://www.youtube.com/watch?v=bMknfKXIFA8" },
          { name: "๐ Deploy React App on GitHub Pages", url: "https://create-react-app.dev/docs/deployment/#github-pages" }
        ]
      }
    ]
  };
  
  // ==============================
  // ุนูุงุตุฑ ุงููุงุฌูุฉ
  // ==============================
  const planContainer = document.getElementById("planContainer");
  const toggleLangBtn = document.getElementById("toggleLang");
  const progressCircle = document.getElementById("progressCircle");
  const progressText = document.getElementById("progressText");
  const downloadBtn = document.getElementById("downloadBtn");
  const calendarGrid = document.getElementById("calendarGrid");
  
  let currentLang = localStorage.getItem("lang") || "ar";
  let completedTasks = JSON.parse(localStorage.getItem("tasks")) || {};
  
  renderPlan();
  renderCalendar();
  updateProgress();
  
  // ==============================
  // ุนุฑุถ ุงูุฎุทุฉ
  // ==============================
  function renderPlan() {
    planContainer.innerHTML = "";
    document.body.dir = currentLang === "ar" ? "rtl" : "ltr";
  
    plan[currentLang].forEach((week, i) => {
      const weekDiv = document.createElement("div");
      weekDiv.className = "week";
  
      const weekTitle = document.createElement("h2");
      weekTitle.textContent = week.week;
      weekDiv.appendChild(weekTitle);
  
      week.days.forEach((task, j) => {
        const taskDiv = document.createElement("div");
        taskDiv.className = "day";
  
        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        const taskKey = `${currentLang}-week${i}-task${j}`;
        checkbox.checked = completedTasks[taskKey] || false;
  
        checkbox.addEventListener("change", () => {
          completedTasks[taskKey] = checkbox.checked;
          localStorage.setItem("tasks", JSON.stringify(completedTasks));
          updateProgress();
        });
  
        const label = document.createElement("label");
        label.textContent = task;
  
        taskDiv.appendChild(checkbox);
        taskDiv.appendChild(label);
        weekDiv.appendChild(taskDiv);
      });
  
      const resDiv = document.createElement("div");
      resDiv.className = "resources";
      week.resources.forEach(r => {
        const link = document.createElement("a");
        link.href = r.url;
        link.target = "_blank";
        link.textContent = r.name;
        resDiv.appendChild(link);
      });
  
      weekDiv.appendChild(resDiv);
      planContainer.appendChild(weekDiv);
    });
  }
  
  // ==============================
  // ุชุญุฏูุซ ุงูุชูุฏูู
  // ==============================
  function updateProgress() {
    const total = document.querySelectorAll(".day input").length;
    const done = Object.values(completedTasks).filter(Boolean).length;
    const percent = Math.round((done / total) * 100) || 0;
  
    progressText.textContent = `${percent}%`;
    progressCircle.style.setProperty("--progress", percent);
  }
  
  // ==============================
  // ุชุจุฏูู ุงููุบุฉ
  // ==============================
  toggleLangBtn.addEventListener("click", () => {
    currentLang = currentLang === "ar" ? "en" : "ar";
    localStorage.setItem("lang", currentLang);
    toggleLangBtn.textContent = currentLang === "ar" ? "๐ English" : "๐ ุงูุนุฑุจูุฉ";
    renderPlan();
    renderCalendar();
  });
  
  // ==============================
  // ุชุญููู PDF
  // ==============================
  downloadBtn.addEventListener("click", () => {
    window.print();
  });
  
  // ==============================
  // ุงูุชูููู ุงูุชูุงุนูู
  // ==============================
  function renderCalendar() {
    calendarGrid.innerHTML = "";
    const now = new Date();
    const year = now.getFullYear();
    const month = now.getMonth();
    const isArabic = currentLang === "ar";
  
    const firstDay = new Date(year, month, 1).getDay();
    const lastDate = new Date(year, month + 1, 0).getDate();
  
    const daysNames = isArabic
      ? ["ุงูุฃุญุฏ", "ุงูุงุซููู", "ุงูุซูุงุซุงุก", "ุงูุฃุฑุจุนุงุก", "ุงูุฎููุณ", "ุงูุฌูุนุฉ", "ุงูุณุจุช"]
      : ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
  
    const title = document.querySelector("#calendar h2");
    const monthName = now.toLocaleString(isArabic ? "ar-EG" : "en-US", { month: "long" });
    title.textContent = `${isArabic ? "๐ ุชูููู ุงูุชูุฏูู ูุดูุฑ" : "๐ Progress Calendar for"} ${monthName} ${year}`;
  
    daysNames.forEach(day => {
      const head = document.createElement("div");
      head.className = "day day-head";
      head.textContent = day;
      calendarGrid.appendChild(head);
    });
  
    let startOffset = isArabic ? (firstDay === 0 ? 6 : firstDay - 1) : firstDay;
    for (let i = 0; i < startOffset; i++) {
      const empty = document.createElement("div");
      empty.className = "day empty";
      calendarGrid.appendChild(empty);
    }
  
    const savedCalendar = JSON.parse(localStorage.getItem("calendarProgress")) || {};
  
    for (let d = 1; d <= lastDate; d++) {
      const cell = document.createElement("div");
      cell.className = "day";
      cell.textContent = d;
      const key = `${year}-${month}-${d}`;
      if (savedCalendar[key]) cell.classList.add("completed");
  
      cell.addEventListener("click", () => {
        cell.classList.toggle("completed");
        savedCalendar[key] = cell.classList.contains("completed");
        localStorage.setItem("calendarProgress", JSON.stringify(savedCalendar));
      });
  
      calendarGrid.appendChild(cell);
    }
  }
  